<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>üé≠ ITALIAN BRAINROT A-Z üáÆüáπ</title>
    
    <!-- Preload critical resources (disabled for file:// compatibility) -->
    <!-- <link rel="preload" href="https://fonts.googleapis.com/css2?family=Bangers&family=Permanent+Marker&display=swap" as="style"> -->
    <!-- <link rel="preload" href="images/jumpscare.jpeg" as="image"> -->
    
    <!-- Optimized CSS -->
    <link rel="stylesheet" href="style.css">
    
    <!-- PWA Manifest (disabled for file:// compatibility) -->
    <!-- <link rel="manifest" href="manifest.json"> -->
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="images/brainrot_icon_v2.png">
    <link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png">
    
    <meta name="description" content="The ultimate Italian Brainrot character encyclopedia! Explore crazy AI-generated characters with wild 3D effects!">
    <meta name="theme-color" content="#ff10f0">
</head>
<body>
    <!-- PARTICLES (GPU Optimized) -->
    <div id="particles-container" class="particles-container"></div>

    <!-- HEADER -->
    <header>
        <div class="language-selector">
            <button class="lang-btn active" onclick="changeLanguage('en')" data-lang="en">üá¨üáß</button>
            <button class="lang-btn" onclick="changeLanguage('de')" data-lang="de">üá©üá™</button>
            <button class="lang-btn" onclick="changeLanguage('es')" data-lang="es">üá™üá∏</button>
            <button class="lang-btn" onclick="changeLanguage('da')" data-lang="da">üá©üá∞</button>
            <button class="lang-btn" onclick="changeLanguage('it')" data-lang="it">üáÆüáπ</button>
        </div>
        <h1>üé≠ ITALIAN BRAINROT üáÆüáπ</h1>
        <p class="subtitle" data-translate="subtitle">THE ULTIMATE A-Z CHARACTER ENCYCLOPEDIA</p>
        
        <!-- INSTALL TO MOBILE BUTTON -->
        <button id="install-btn" class="install-btn" style="display:none;" onclick="installApp()">
            üì± <span data-translate="installApp">INSTALL TO MOBILE</span>
        </button>
    </header>

    <!-- PWA INSTALL POPUP (MOBILE) -->
    <div id="pwa-popup" class="pwa-popup" style="display: none;">
        <div class="pwa-popup-overlay" onclick="closePWAPopup()"></div>
        <div class="pwa-popup-content">
            <button class="pwa-popup-close" onclick="closePWAPopup()">‚úï</button>
            <div class="pwa-popup-icon">üß†üöΩ</div>
            <h2 data-translate="pwaPopupTitle">Install Italian Brainrot</h2>
            <p data-translate="pwaPopupDesc">Add to your home screen for the full brainrot experience!</p>
            <button class="pwa-popup-install" onclick="installFromPopup()">
                <span data-translate="pwaPopupInstall">Install Now</span> üöÄ
            </button>
            <button class="pwa-popup-later" onclick="closePWAPopup()">
                <span data-translate="pwaPopupLater">Maybe Later</span>
            </button>
        </div>
    </div>

    <!-- ALPHABET NAVIGATION (Dynamic) -->
    <nav id="alphabet-nav" class="alphabet-nav">
        <!-- Generated by JavaScript -->
    </nav>

    <!-- GAMES MENU -->
    <div id="game-mode-selection" class="mode-selection-overlay" style="display:none;">
        <div class="mode-selection-container">
            <!-- X Close button -->
            <button onclick="document.getElementById('game-mode-selection').style.display='none'; document.getElementById('play-quiz-btn').style.display='';" style="
                position: absolute;
                top: 10px;
                right: 10px;
                background: rgba(255,255,255,0.1);
                border: 2px solid #ff10f0;
                border-radius: 50%;
                width: 35px;
                height: 35px;
                font-size: 1.3rem;
                color: #ff10f0;
                cursor: pointer;
                z-index: 10;
            ">‚úï</button>
            
            <h2 class="mode-selection-title">üéÆ GAMES üéÆ</h2>
            
            <!-- GAME 1: NAME QUIZ -->
            <div class="game-section">
                <h3 class="game-section-title" style="color: #00ffff;">üß† NAME QUIZ</h3>
                <div class="mode-options">
                    <div class="mode-option mode-chicken" onclick="selectGameMode('chicken')">
                        <div class="mode-icon">üêî</div>
                        <div class="mode-name">CHICKEN</div>
                        <div class="mode-description">Normal ‚Ä¢ 5 lives</div>
                    </div>
                    <div class="mode-option mode-chaos" onclick="selectGameMode('chaos')">
                        <div class="mode-icon">üî•</div>
                        <div class="mode-name">CHAOS</div>
                        <div class="mode-description">Insane ‚Ä¢ 3 lives ‚Ä¢ Crazy!</div>
                    </div>
                </div>
                <div class="highscore-mini" style="border-color: rgba(0,255,255,0.3);">
                    <span>üèÜ</span><div id="mode-highscore-list"></div>
                </div>
            </div>
            
            <!-- GAME 2: WHO IS IT -->
            <div class="game-section">
                <h3 class="game-section-title" style="color: #9932cc;">üîä WHO IS IT?</h3>
                <div class="mode-options">
                    <div class="mode-option mode-whoisit" onclick="selectGameMode('whoisit')">
                        <div class="mode-icon">üîä</div>
                        <div class="mode-name">PLAY</div>
                        <div class="mode-description">Hear name ‚Ä¢ Pick picture ‚Ä¢ Speed bonus!</div>
                    </div>
                </div>
                <div class="highscore-mini" style="border-color: rgba(153,50,204,0.3);">
                    <span>üèÜ</span><div id="whoisit-highscore-menu"></div>
                </div>
            </div>
            
            <!-- GAME 3: MEMORY -->
            <div class="game-section">
                <h3 class="game-section-title" style="color: #00ff00;">üÉè MEMORY</h3>
                <div class="mode-options">
                    <div class="mode-option mode-memory" onclick="selectGameMode('memory')">
                        <div class="mode-icon">‚è±Ô∏è</div>
                        <div class="mode-name">SOLO</div>
                        <div class="mode-description">30 cards ‚Ä¢ Fastest time!</div>
                    </div>
                    <div class="mode-option mode-memoryhc" onclick="selectGameMode('memoryhc')">
                        <div class="mode-icon">üíÄ</div>
                        <div class="mode-name">HARDCORE</div>
                        <div class="mode-description">Idle shuffle ‚Ä¢ 5 wrong = shuffle</div>
                    </div>
                    <div class="mode-option mode-memory2p" onclick="selectGameMode('memory2p')">
                        <div class="mode-icon">üë•</div>
                        <div class="mode-name">2P</div>
                        <div class="mode-description">Match = extra turn!</div>
                    </div>
                </div>
                <div class="highscore-mini" style="border-color: rgba(0,255,0,0.3);">
                    <span>üèÜ Solo:</span><div id="memory-highscore-menu"></div>
                </div>
                <div class="highscore-mini" style="border-color: rgba(255,0,0,0.3);">
                    <span>üíÄ HC:</span><div id="memoryhc-highscore-menu"></div>
                </div>
            </div>
            
            <!-- GAME 4: SPEED REMEMBER -->
            <div class="game-section">
                <h3 class="game-section-title" style="color: #ff6600;">‚ö° SPEED REMEMBER</h3>
                <div class="mode-options">
                    <div class="mode-option mode-speedremember" onclick="selectGameMode('speedremember')">
                        <div class="mode-icon">üß†</div>
                        <div class="mode-name">SOLO</div>
                        <div class="mode-description">25 cards ‚Ä¢ 3 lives ‚Ä¢ Speed bonus!</div>
                    </div>
                    <div class="mode-option mode-speedremember2p" onclick="selectGameMode('speedremember2p')">
                        <div class="mode-icon">üë•</div>
                        <div class="mode-name">2P</div>
                        <div class="mode-description">16 cards ‚Ä¢ Take turns!</div>
                    </div>
                </div>
                <div class="highscore-mini" style="border-color: rgba(255,102,0,0.3);">
                    <span>üèÜ</span><div id="speedremember-highscore-menu"></div>
                </div>
            </div>
            
            <!-- GAME 5: CONNECT 4 -->
            <div class="game-section">
                <h3 class="game-section-title" style="color: #ff00ff;">üî¥üü° 4 P√Ö STRIBE</h3>
                <div class="mode-options">
                    <div class="mode-option mode-connect4" onclick="selectGameMode('connect4')">
                        <div class="mode-icon">üéÆ</div>
                        <div class="mode-name">2 PLAYERS</div>
                        <div class="mode-description">V√¶lg din helt ‚Ä¢ 4 p√• stribe!</div>
                    </div>
                </div>
            </div>
            
            <!-- GAME 6: BRAINROT CRUSH -->
            <div class="game-section">
                <h3 class="game-section-title" style="color: #ff69b4;">üç¨ BRAINROT CRUSH</h3>
                <div class="mode-options">
                    <div class="mode-option mode-crush" onclick="selectGameMode('crush')">
                        <div class="mode-icon">üíé</div>
                        <div class="mode-name">CLASSIC</div>
                        <div class="mode-description">Match 3+ karakterer ‚Ä¢ F√• highscore!</div>
                    </div>
                </div>
                <div class="highscore-mini" style="border-color: rgba(255,105,180,0.3);">
                    <span>üèÜ</span><div id="crush-highscore-menu"></div>
                </div>
            </div>
            
            <!-- GAME 7: FLAPPYROT -->
            <div class="game-section">
                <h3 class="game-section-title" style="color: #00ffff;">üê¶ FLAPPYROT</h3>
                <div class="mode-options">
                    <div class="mode-option mode-flappy" onclick="selectGameMode('flappy')">
                        <div class="mode-icon">üöÄ</div>
                        <div class="mode-name">FLY!</div>
                        <div class="mode-description">Flap gennem r√∏rene ‚Ä¢ Undg√• crash!</div>
                    </div>
                </div>
                <div class="highscore-mini" style="border-color: rgba(0,255,255,0.3);">
                    <span>üèÜ</span><div id="flappy-highscore-menu"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- GAME OVERLAY (Isolated from body transforms) -->
    <div id="game-overlay" class="game-overlay" style="display:none;">
        <div id="game-container">
        <!-- Chaos Mode Indicator -->
        <div id="chaos-mode-indicator" class="chaos-mode-indicator" style="display:none;">
            üî• CHAOS MODE ACTIVE! üî•
        </div>
        
        <!-- Game Stats -->
        <div class="game-header">
            <div class="game-stat">
                <span class="game-stat-label" data-translate="score">SCORE:</span>
                <span id="game-score" class="game-stat-value">0</span>
            </div>
            <div class="game-stat">
                <span class="game-stat-label" data-translate="questions">QUESTIONS:</span>
                <span id="game-questions" class="game-stat-value">0</span>
            </div>
            <div class="game-stat">
                <span class="game-stat-label" data-translate="time">TIME:</span>
                <span id="game-time" class="game-stat-value">60s</span>
            </div>
            <div class="game-stat">
                <span class="game-stat-label" data-translate="lives">LIVES:</span>
                <span id="game-lives" class="game-stat-value">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</span>
            </div>
            <div class="game-stat">
                <span class="game-stat-label" data-translate="streak">STREAK:</span>
                <span id="game-streak" class="game-stat-value">-</span>
            </div>
        </div>
        
        <!-- Timer Bar -->
        <div class="timer-bar-container">
            <div id="timer-bar" style="width: 100%;"></div>
        </div>
        
        <!-- Character Image -->
        <div class="game-character-container">
            <img id="game-character-image" src="" alt="Character">
        </div>
        
        <!-- Answer Options -->
        <div id="game-options" class="game-options">
            <!-- Generated by JavaScript -->
        </div>
        
        <!-- Combo Display -->
        <div id="combo-display" class="streak-indicator" style="display:none;"></div>
        
        <!-- Chaos Meter -->
        <div id="chaos-meter" class="chaos-meter" style="display:none;">
            <div class="chaos-meter-label" data-translate="kaosLevel">CHAOS LEVEL:</div>
            <div class="chaos-bar">
                <div id="chaos-fill" style="width: 0%;"></div>
            </div>
            <div id="chaos-text" style="text-align:center; margin-top:5px;">0% üòå</div>
        </div>
        </div>
    </div>
    
    <!-- FEEDBACK -->
    <div id="game-feedback" style="display:none;"></div>

    <!-- WHO IS IT GAME OVERLAY -->
    <div id="whoisit-overlay" class="game-overlay" style="display:none;">
        <div id="whoisit-container" class="whoisit-container">
            <!-- Game Stats -->
            <div class="game-header">
                <div class="game-stat">
                    <span class="game-stat-label">SCORE:</span>
                    <span id="whoisit-score" class="game-stat-value">0</span>
                </div>
                <div class="game-stat">
                    <span class="game-stat-label">ROUND:</span>
                    <span id="whoisit-round" class="game-stat-value">1</span>
                </div>
                <div class="game-stat">
                    <span id="whoisit-lives" class="game-stat-value">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</span>
                </div>
            </div>
            
            <!-- Question -->
            <div class="whoisit-question">
                <h2 id="whoisit-title">üîä WHO IS IT? üîä</h2>
                <button id="whoisit-play-sound" onclick="WhoIsItGame.playCurrentName()" class="play-sound-btn">
                    üîä PLAY SOUND AGAIN
                </button>
            </div>
            
            <!-- Image Choices (2x2 grid) -->
            <div id="whoisit-choices" class="whoisit-choices">
                <!-- 4 image buttons will be generated here -->
            </div>
            
            <!-- Timer -->
            <div class="timer-container">
                <div id="whoisit-timer-bar" class="timer-bar"></div>
            </div>
        </div>
    </div>

    <!-- MEMORY GAME OVERLAY -->
    <div id="memory-overlay" class="game-overlay" style="display:none;">
        <div id="memory-container" class="memory-container">
            <!-- Game Stats -->
            <div class="game-header" style="justify-content: space-between;">
                <div class="game-stat">
                    <span class="game-stat-label">‚è±Ô∏è TIME:</span>
                    <span id="memory-time" class="game-stat-value" style="color: #00ff00;">0.000s</span>
                </div>
                <div class="game-stat">
                    <span class="game-stat-label">PAIRS:</span>
                    <span id="memory-pairs" class="game-stat-value">0/10</span>
                </div>
                <div class="game-stat">
                    <span class="game-stat-label">MOVES:</span>
                    <span id="memory-moves" class="game-stat-value">0</span>
                </div>
            </div>
            
            <!-- Memory Grid -->
            <div id="memory-grid" class="memory-grid">
                <!-- Generated by JavaScript -->
            </div>
            
            <!-- Exit Button -->
            <button onclick="MemoryGame.exit()" ontouchend="MemoryGame.exit(); event.preventDefault();" style="
                margin-top: 20px;
                background: linear-gradient(145deg, #ff4444, #aa0000);
                border: none;
                border-radius: 15px;
                padding: 12px 25px;
                font-family: 'Bangers', cursive;
                font-size: 1.2rem;
                color: white;
                cursor: pointer;
                touch-action: manipulation;
            ">üö™ EXIT GAME</button>
        </div>
    </div>

    <!-- HIGHSCORE ENTRY -->
    <div id="highscore-entry" class="mode-selection-overlay" style="display:none;">
        <div class="mode-selection-container" style="max-width:500px;">
            <h2 class="mode-selection-title">üèÜ NEW HIGHSCORE! üèÜ</h2>
            <p style="font-size:2rem; color:#ffff00; margin:20px 0;">
                Score: <span id="final-score-display">0</span>
            </p>
            <input type="text" id="highscore-name" placeholder="Enter your name" 
                   style="width:100%; padding:15px; font-size:1.5rem; border-radius:10px; border:3px solid #ff10f0; background:#1a0033; color:white; text-align:center; margin:20px 0;">
            <button onclick="submitHighscore()" 
                    style="width:100%; padding:15px; font-size:1.5rem; background:linear-gradient(145deg, #ff10f0, #00ffff); border:none; border-radius:10px; color:white; cursor:pointer; font-family:'Bangers',cursive;">
                SAVE HIGHSCORE
            </button>
        </div>
    </div>

    <!-- CHARACTERS CONTAINER -->
    <div class="characters-container">
        <div id="characters-grid" class="characters-grid">
            <div class="loading">LOADING BRAINROT... üß†</div>
        </div>
    </div>

    <!-- CHARACTER MODAL -->
    <div id="character-modal" class="character-modal" style="display:none;" onclick="closeCharacterModal(event)">
        <div class="modal-content" onclick="event.stopPropagation();">
            <button class="modal-close" onclick="closeCharacterModal()">√ó</button>
            
            <div style="display:flex; flex-wrap:wrap; gap:30px; align-items:flex-start;">
                <div style="flex:1; min-width:250px; text-align:center;">
                    <img id="modal-image" src="" alt="" style="width:100%; max-width:300px; border-radius:20px; border:4px solid #ff10f0;">
                </div>
                
                <div style="flex:1; min-width:250px;">
                    <div id="modal-emoji" style="font-size:4rem; margin-bottom:10px;"></div>
                    <h2 id="modal-name" style="font-family:'Bangers',cursive; font-size:2.5rem; color:#ffff00; margin-bottom:10px;"></h2>
                    <div id="modal-rarity" style="font-size:1.5rem; margin-bottom:20px;"></div>
                    <p id="modal-description" style="font-size:1.2rem; line-height:1.6; color:#00ffff;"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- FOOTER -->
    <footer>
        <div class="footer-characters">
            <!-- Generated by JavaScript -->
        </div>
        <p style="color:#00ffff; font-size:1.2rem;">
            üé≠ ITALIAN BRAINROT FOREVER! üáÆüáπ
        </p>
    </footer>

    <!-- GAMES BUTTON - Fixed position -->
    <button id="play-quiz-btn" onclick="showGameModeSelection()" style="
        position: fixed !important;
        bottom: 30px !important;
        right: 30px !important;
        padding: 20px 40px !important;
        font-size: 1.8rem !important;
        font-family: 'Bangers', cursive !important;
        background: linear-gradient(145deg, #ff10f0, #00ffff) !important;
        border: 4px solid white !important;
        border-radius: 25px !important;
        color: white !important;
        cursor: pointer !important;
        z-index: 99999 !important;
        box-shadow: 0 0 50px #ff10f0, 0 0 100px rgba(255,16,240,0.8) !important;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.8) !important;
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
    ">
        üéÆ GAMES
    </button>

    <!-- BRAINROT RADIO BUTTON -->
    <button id="random-sound-btn" onclick="playRandomBrainrotSound()" title="BRAINROT RADIO üìª" style="
        position: fixed !important;
        bottom: 30px !important;
        left: 30px !important;
        padding: 10px !important;
        font-size: 1rem !important;
        font-family: 'Bangers', cursive !important;
        background: linear-gradient(145deg, #ff6600, #ffcc00) !important;
        border: 4px solid white !important;
        border-radius: 20px !important;
        color: white !important;
        cursor: pointer !important;
        z-index: 99999 !important;
        box-shadow: 0 0 30px #ff6600, 0 0 60px rgba(255,102,0,0.6) !important;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.8) !important;
        display: flex !important;
        align-items: center !important;
        gap: 8px !important;
        transition: transform 0.2s, box-shadow 0.2s !important;
    " onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 0 50px #ff6600, 0 0 100px rgba(255,102,0,0.8)'" 
       onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 30px #ff6600, 0 0 60px rgba(255,102,0,0.6)'">
        üìª BRAINROT RADIO
    </button>

    <!-- SCRIPTS (Optimized) -->
    <script src="translations.js"></script>
    <script src="characters.js"></script>
    <script src="descriptions.js"></script>
    <script src="script.js"></script>
    <script src="game.js"></script>
    
    <!-- Firebase SDK (async - loaded after main app) -->
    <script defer src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script defer src="firebase-config.js"></script>
    
    <!-- Initialize Firebase after everything loads -->
    <script>
        window.addEventListener('load', () => {
            // Wait a bit for Firebase SDK to load
            setTimeout(() => {
                if (window.FirebaseConfig) {
                    window.FirebaseConfig.init();
                }
            }, 1000);
        });
    </script>
</body>
</html>
